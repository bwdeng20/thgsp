

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introduction by Example &mdash; thgsp 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GraphQmf Wavelet Filterbank" href="waveletfb.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction by Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#graph-in-thgsp">Graph in thgsp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graph-fourier-transform">Graph Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graph-filter-bank-in-thgsp">Graph Filter(bank) in thgsp</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="waveletfb.html">GraphQmf Wavelet Filterbank</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/graphs.html">thgsp.graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/bga.html">thgsp.bga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/filters.html">thgsp.filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/alg.html">thgsp.alg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/datasets.html">thgsp.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/sampling.html">thgsp.sampling</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">thgsp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Introduction by Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notes/introduction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-by-example">
<h1>Introduction by Example<a class="headerlink" href="#introduction-by-example" title="Permalink to this headline">¶</a></h1>
<p>We introduce the fundamental components of thgsp here.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#graph-in-thgsp" id="id6">Graph in thgsp</a></p></li>
<li><p><a class="reference internal" href="#graph-fourier-transform" id="id7">Graph Fourier Transform</a></p></li>
<li><p><a class="reference internal" href="#graph-filter-bank-in-thgsp" id="id8">Graph Filter(bank) in thgsp</a></p></li>
</ul>
</div>
<div class="section" id="graph-in-thgsp">
<h2><a class="toc-backref" href="#id6">Graph in thgsp</a><a class="headerlink" href="#graph-in-thgsp" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You are supposed to follow the code blocks step by step to avoid any program error.</p>
</div>
<p>A graph in <a class="reference external" href="https://github.com/bwdeng20/thgsp">thgsp</a> is
an instance of <a class="reference internal" href="../modules/graphs.html#thgsp.graphs.Graph" title="thgsp.graphs.Graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thgsp.graphs.Graph</span></code></a> (for undirected graph) or
<a class="reference internal" href="../modules/graphs.html#thgsp.graphs.DiGraph" title="thgsp.graphs.DiGraph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thgsp.graphs.DiGraph</span></code></a> (for directed graph). You can initiate it from an adjacency matrix with any type
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.spmatrix</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">thgsp.graphs</span> <span class="kn">import</span> <span class="n">random_graph</span>
<span class="n">N</span><span class="o">=</span><span class="mi">8</span> <span class="c1"># number of nodes</span>
<span class="n">g</span><span class="o">=</span><span class="n">random_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">weighted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">g2</span><span class="o">=</span><span class="n">random_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
</pre></div>
</div>
<p>You can draw graphs with tools in <code class="xref py py-obj docutils literal notranslate"><span class="pre">thgsp.visual</span></code>, which employs <code class="xref py py-obj docutils literal notranslate"><span class="pre">networkx</span></code> to plot. Execute the following
block.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">thgsp.visual</span> <span class="kn">import</span> <span class="n">draw</span><span class="p">,</span><span class="n">draw_cn</span><span class="p">,</span> <span class="n">draw_signal</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>     <span class="c1"># plain draw of graph</span>
<span class="n">draw_cn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># draw_cn will by default assign different colors to nodes.</span>
<span class="c1"># `cmap` is the colormap of node colors,  `edge_cmap` is the colormap of edge colors.</span>
<span class="n">draw_signal</span><span class="p">(</span><span class="n">g2</span><span class="p">,</span><span class="n">signal</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;jet&#39;</span><span class="p">),</span> <span class="n">edge_cmap</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;copper&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You will get an image like this.</p>
<img alt="../_images/thgsp-visual.svg" class="align-center" src="../_images/thgsp-visual.svg" /></div>
<div class="section" id="graph-fourier-transform">
<h2><a class="toc-backref" href="#id7">Graph Fourier Transform</a><a class="headerlink" href="#graph-fourier-transform" title="Permalink to this headline">¶</a></h2>
<p>To support brute-force graph filtering, <a class="reference internal" href="../modules/graphs.html#thgsp.graphs.Graph" title="thgsp.graphs.Graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thgsp.graphs.Graph</span></code></a> can produce graph Fourier basis and graph frequencies
either in a <em>on-the-fly</em> or cache way. For large graphs, it can be unfriendly to cache them with respect to both memory
and computation since the graph Fourier basis is usually dense matrix. Note that <a class="reference internal" href="../modules/graphs.html#thgsp.graphs.DiGraph" title="thgsp.graphs.DiGraph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thgsp.graphs.DiGraph</span></code></a>’s
adjacency matrix are not symmetric and there is no acknowledged corresponding graph Fourier transform(GFT) defined.
Denote the adjacency and Laplacian(either normalized or not) matrices of an undirected graph
by <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(L\)</span> respectively, the Graph Fourier transform(GFT) originates from the eigenvalue
decomposition of either <span class="math notranslate nohighlight">\(A\)</span> or <span class="math notranslate nohighlight">\(L\)</span>. As both of two are symmetric, there must be an unitary matrix <span class="math notranslate nohighlight">\(U\)</span>
such that <span class="math notranslate nohighlight">\(A=U\Lambda U^T(or L=U\Lambda U^T)\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="n">L</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>         <span class="c1"># SparseTensor</span>
<span class="n">basis</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">U</span><span class="p">()</span>     <span class="c1"># dense tensor</span>
<span class="n">frequency</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="n">evd_err</span><span class="o">=</span><span class="p">(</span><span class="n">basis</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span> <span class="o">@</span> <span class="n">basis</span><span class="o">.</span><span class="n">t</span><span class="p">()</span><span class="o">-</span> <span class="n">L</span><span class="o">.</span><span class="n">to_dense</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># check the EVD of normalized Laplacian</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evd_err</span><span class="p">)</span>  <span class="c1"># expected to be tiny</span>
</pre></div>
</div>
<p>In the remainder contents, we adopt the graph Fourier transform defined with the normalized Laplacian
<span class="math notranslate nohighlight">\(L=I-D^{-1/2}AD^{-1/2}\)</span>. Then GFT and the consequent spectral filtering can be formulated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{\begin{array}{ll}
G F T &amp; \hat{s}_{\mathrm{in}}=U^{T} s_{\mathrm{in}} \\
F i l t e r i n g &amp; \hat{s}_{\mathrm{out}}=h(\Lambda) \hat{s}_{\mathrm{in}} \\
I G F T &amp; s_{\mathrm{out}}=U \hat{s}_{\mathrm{out}} \\
\end{array}\right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_{in}\)</span> and <span class="math notranslate nohighlight">\(s_{out}\)</span> are the input and output graph signals, separately and <span class="math notranslate nohighlight">\(\hat{s}_{in}\)</span>
is the graph Fourier coefficient of <span class="math notranslate nohighlight">\(s_{in}\)</span>. After transforming <span class="math notranslate nohighlight">\(s_{in}\)</span> into the spectral domain, a
polynomial function(kernel) <span class="math notranslate nohighlight">\(h(\Lambda)\)</span> defined in the graph spectrum performs a element-wise
multiplication with <span class="math notranslate nohighlight">\(\hat{s}_{in}\)</span> to attenuate or enhance spectral components of <span class="math notranslate nohighlight">\(s_{in}\)</span>. For example,
if you’d like to filter out components with high frequency, i.e., high vibration, a low-pass kernel <span class="math notranslate nohighlight">\(h(\Lambda)\)</span>,
e.g., <span class="math notranslate nohighlight">\(h_0\)</span> displayed below, is desired.(Also you can see a high-pass kernel <span class="math notranslate nohighlight">\(h_1\)</span>)</p>
<img alt="../_images/meyer.svg" class="align-center" src="../_images/meyer.svg" /><p>The bellowing code snippet shows graph Fourier transform on a random graph signal.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="n">s_in</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">s_in_hat</span><span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">@</span> <span class="n">s_in</span>  <span class="c1"># GFT</span>
<span class="n">s_out_hat</span><span class="o">=</span><span class="n">s_in_hat</span>          <span class="c1"># Don&#39;t change any spectral components here</span>
<span class="n">s_out</span><span class="o">=</span><span class="n">basis</span> <span class="o">@</span> <span class="n">s_out_hat</span>     <span class="c1"># IGFT</span>
<span class="n">err</span><span class="o">=</span><span class="p">(</span><span class="n">s_in</span><span class="o">-</span><span class="n">s_out</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>     <span class="c1"># The signal is unaltered</span>
<span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s try to attenuate the high-frequency components. which can be done with an ideal low-pass filter. You can define an
ideal low-pass kernel or just import it from <strong>thgsp</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="k">def</span> <span class="nf">my_ideal_kernel</span><span class="p">(</span><span class="n">frequencies</span><span class="p">):</span>       <span class="c1"># define the ideal low-pass kernel</span>
    <span class="n">y</span><span class="o">=</span><span class="n">frequencies</span><span class="o">.</span><span class="n">new_ones</span><span class="p">(</span><span class="n">frequencies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">frequencies</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">y</span><span class="p">[</span><span class="n">frequencies</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="n">fs</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
<span class="n">response</span><span class="o">=</span><span class="n">my_ideal_kernel</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>    <span class="c1"># the response of my_ideal_kernel</span>
<span class="n">s_out_hat</span><span class="o">=</span> <span class="n">response</span> <span class="o">*</span> <span class="n">s_in_hat</span>
<span class="n">s_out</span><span class="o">=</span><span class="n">basis</span> <span class="o">@</span> <span class="n">s_out_hat</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frequency:   &quot;</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s_out:       &quot;</span><span class="p">,</span><span class="n">s_out</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;std of s_in: &quot;</span><span class="p">,</span><span class="n">s_in</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;std of s_out:&quot;</span><span class="p">,</span><span class="n">s_out</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that all eigenvalues of symmetric normalized Laplacian are all scattered in <span class="math notranslate nohighlight">\([0,2]\)</span> and
<span class="math notranslate nohighlight">\(1\)</span> is the frequency that bisects the frequency domain.</p>
</div>
<p>After the low-pass filtering, we get a smoother graph signal <span class="math notranslate nohighlight">\(s_{out}\)</span>, which has less vibration. You can plot
<span class="math notranslate nohighlight">\(s_{out}\)</span> and  <span class="math notranslate nohighlight">\(s_{in}\)</span> to check that.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="n">xy</span><span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">is_directed</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># draw graph signals</span>
<span class="n">maximum</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">s_out</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">s_in</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">minimum</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">s_out</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">s_in</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;The input signal&quot;</span><span class="p">)</span>
<span class="n">draw_signal</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">s_in</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">minimum</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">maximum</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;The output signal&quot;</span><span class="p">)</span>
<span class="n">draw_signal</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">s_out</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">minimum</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">maximum</span><span class="p">)</span>

<span class="c1"># plot kernel and response</span>
<span class="n">fre</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;s_in_hat&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">s_in_hat</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span><span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;GFT coeffs of $s_</span><span class="si">{in}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fre</span><span class="p">,</span><span class="n">my_ideal_kernel</span><span class="p">(</span><span class="n">fre</span><span class="p">),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ideal kernel&quot;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\lambda$/ graph frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;s_out_hat&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">s_out_hat</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span><span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;GFT coeffs of $s_</span><span class="si">{out}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fre</span><span class="p">,</span><span class="n">my_ideal_kernel</span><span class="p">(</span><span class="n">fre</span><span class="p">),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ideal kernel&quot;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\lambda$/ graph frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You could see a figure similar to the following one.</p>
<img alt="../_images/GFTdemo.svg" class="align-center" src="../_images/GFTdemo.svg" /></div>
<div class="section" id="graph-filter-bank-in-thgsp">
<h2><a class="toc-backref" href="#id8">Graph Filter(bank) in thgsp</a><a class="headerlink" href="#graph-filter-bank-in-thgsp" title="Permalink to this headline">¶</a></h2>
<p>The plain GFT filter(bank) is implemented as <a class="reference internal" href="../modules/filters.html#thgsp.filters.Filter" title="thgsp.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">thgsp.filters.Filter</span></code></a>, which keeps <code class="xref py py-obj docutils literal notranslate"><span class="pre">Co*Ci</span></code> frequency
response kernels (functions) to filter <code class="xref py py-obj docutils literal notranslate"><span class="pre">Ci</span></code> input channel signals and combine the results to get <code class="xref py py-obj docutils literal notranslate"><span class="pre">Co</span></code> output
channel signals, with predefined channel aggregation weights. <a class="reference internal" href="../modules/filters.html#thgsp.filters.Filter" title="thgsp.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">thgsp.filters.Filter</span></code></a> can cope with
the input signals carried by either <code class="xref py py-obj docutils literal notranslate"><span class="pre">(N,Ci)</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">(N,)</span></code> <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>. We now introduce it with a plainest
case wherein the processing of a <code class="xref py py-obj docutils literal notranslate"><span class="pre">(N,)</span></code> tensor by <a class="reference internal" href="../modules/filters.html#thgsp.filters.Filter" title="thgsp.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">thgsp.filters.Filter</span></code></a> with only 1 input and output channel
is considered.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="kn">from</span> <span class="nn">thgsp.filters</span> <span class="kn">import</span> <span class="n">Filter</span>
<span class="n">filter1</span><span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">my_ideal_kernel</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filter1</span><span class="p">)</span>                          <span class="c1"># check the information of filter1</span>
<span class="n">y1</span><span class="o">=</span> <span class="n">filter1</span><span class="p">(</span><span class="n">s_in</span><span class="p">,</span><span class="n">cheby</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           <span class="c1"># Filtering s_in</span>
<span class="n">y2</span><span class="o">=</span> <span class="n">filter1</span><span class="p">(</span><span class="n">s_in</span><span class="p">)</span>                       <span class="c1"># Filtering s_in with 100-deg Chebyshev approximation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y1   :&quot;</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y2   :&quot;</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s_out:&quot;</span><span class="p">,</span> <span class="n">s_out</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">s_out</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-6</span>    <span class="c1"># check the result by comparing y1 with s_out</span>
</pre></div>
</div>
<p>As shown by <code class="xref py py-obj docutils literal notranslate"><span class="pre">y2</span></code>, the error of Chebyshev approximation is not trivial. This err can be decreased via replacing
ideal low-pass kernel by other ones having smoother transition at λ = 1.</p>
<p>Such graph filter has already been implemented in <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/">pygsp</a>. Let’s try
something new. Suppose our signals are with 3 input channels, and we tend to transform them into signals(or features)
with 2 output channels. To construct such MIMO style graph filter banks, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Co</span> <span class="pre">x</span> <span class="pre">Ci</span></code> (here <code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">3=6</span></code>) kernels
are in need. The signal of each output channel is determined by those of all input channels. You may be
curious about how <code class="xref py py-obj docutils literal notranslate"><span class="pre">6</span></code> filtered signals are transformed to <code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span></code> signals. The mechanism is as simple as
a weighted summation of <code class="xref py py-obj docutils literal notranslate"><span class="pre">3</span></code> filtered signals. And the weights can be determined by users when they
initialize an instance of <a class="reference internal" href="../modules/filters.html#thgsp.filters.Filter" title="thgsp.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">thgsp.filters.Filter</span></code></a> or just leave them identical to 1 by default.
In <strong>thgsp</strong>, such MIMO filterbanks require a <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> of kernels shaped as <code class="xref py py-obj docutils literal notranslate"><span class="pre">Co</span> <span class="pre">x</span> <span class="pre">Ci</span></code>.
Let’s create a filter-bank consisting of ideal low-pass  and ideal high-pass kernels.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="k">def</span> <span class="nf">ideal_hp_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>         <span class="c1"># define an ideal high-pass kernel</span>
    <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">new_ones</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">y</span><span class="p">[</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">y</span>
<span class="n">krns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">my_ideal_kernel</span><span class="p">,</span>    <span class="n">my_ideal_kernel</span><span class="p">,</span>    <span class="n">my_ideal_kernel</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">ideal_hp_kernel</span><span class="p">,</span> <span class="n">ideal_hp_kernel</span><span class="p">,</span>   <span class="n">ideal_hp_kernel</span><span class="p">]])</span>  <span class="c1"># 2(Cout) x 3(Cin) kernel array</span>
<span class="n">mimo_filter</span><span class="o">=</span><span class="n">Filter</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">krns</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mimo_filter</span><span class="p">)</span>
<span class="n">out1</span><span class="o">=</span><span class="n">mimo_filter</span><span class="p">(</span><span class="n">s_in</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
<span class="n">out2</span><span class="o">=</span><span class="n">mimo_filter</span><span class="p">(</span><span class="n">s_in</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>       <span class="c1"># (8, 2)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>       <span class="c1"># (8, 2)</span>
</pre></div>
</div>
<p>The signal of first output channel is a weighted summation of three filtered input signals.
Since all-one weights are used by default,  <code class="xref py py-obj docutils literal notranslate"><span class="pre">s_out</span></code> ought to be 3 times over <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code> in the
first output channel.  Check it!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==&gt; continue the last code block</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">out1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">out2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
</div>
<p>The full eigenvalue decomposition of large sparse matrix is insufferably slow. Hence David K Hammond,
et. al., <a class="footnote-reference brackets" href="#id4" id="id1">1</a> propose to bypass EVD with Chebyshev approximation. But the approximation error for some kernels is
not negligible in the context of GFT-based filters. Beyond GFT is graph wavelet analysis.
David K Hammond, et al., have built  one framework of graph wavelet analysis, and the details can be found in the
referenced paper. We don’t provide out-of-the-box tools for this analysis framework because there is an official
package – <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/">pygsp</a> that supports it. Even so, you can implement them on the basis of
<a class="reference internal" href="../modules/filters.html#thgsp.filters.Filter" title="thgsp.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">thgsp.filters.Filter</span></code></a>.</p>
<p>In the next note, we introduce a two-channel wavelet filterbank <a class="footnote-reference brackets" href="#id5" id="id3">2</a> for bipartite graph and extendable for arbitrary
undirected graph. This wavelet filterbank determines one kind of graph wavelet transform distinguishing itself from the
aforementioned one by the critical sampling, which means that the number of wavelet coefficients is equal to that of
graph nodes.</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>David K Hammond, et al., Wavelets on Graphs via Spectral Graph Theory, 2011</p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Sunil K. Narang, et al, Perfect Reconstruction Two-Channel Wavelet Filter Banks for Graph Structured Data, 2012</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="waveletfb.html" class="btn btn-neutral float-right" title="GraphQmf Wavelet Filterbank" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Bowen Deng.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>